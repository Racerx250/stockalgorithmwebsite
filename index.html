<html>

<head>

	<!-- Update the title to your name or the name of your business -->
	<title>Toetrekker trading bot</title>
	<meta charset="UTF-8">
	<!-- Make the site responsive-friendly -->
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- Include Font Awesome for icons -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">

	<!-- Include Montserrat font from Google Fonts -->
	<link href="https://fonts.googleapis.com/css?family=Montserrat:200,300,400,700" rel="stylesheet">

	<link rel="icon" href="images/robot-emoji.png">

	<!-- <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css"> -->


<!-- 	<link rel="stylesheet" href="css/overviewstyle.css">
 -->
	<script>
	<!--
	var loaded = false;
	function getStylesheet() {
		var currentMinutes = new Date().getMinutes();
		var currentHours = new Date().getHours();

		currentTime = currentMinutes + (currentHours*60);

	    if (currentTime < 510 || currentTime > 900) {
	    	console.log("CLOSED");
	       	document.write("<link rel='stylesheet' href='css/indexclosedstyle.css'>");
	    } else {
	    	console.log("OPEN");
	    	document.write("<link rel='stylesheet' href='css/indexopenstyle.css'>");
      	}
	}

	getStylesheet();

	// function get_doc(id)
	// {
 //    	const url = 'https://www.googleapis.com/drive/v3/files/'+id+'?alt=media';
 //    	if(self.fetch){
 //    		var setHeaders = new Headers();
 //    		setHeaders.append('Authorization', 'Bearer ' + "831404325694-f6fngl1uo3dk6oporkkei6b0s0ptduku.apps.googleusercontent.com");
 //    		setHeaders.append('Content-Type', 'service');

 //   			var setOptions = { method: 'GET',
 //        					   headers: setHeaders };

 //    		fetch(url,setOptions).then(response => { 
 //    			if(response.ok)
 //    			{
 //        			var reader = response.body.getReader();
 //        			var decoder = new TextDecoder();
 //        			reader.read().then(function(result){
 //           				var data = {};
 //            			data = decoder.decode(result.value, {stream: !result.done});
 //            			console.log(data);
 //    				});
 //        		} else{
 //        			console.log("Response wast not ok");
 //    			}
 //  			}).catch(error => {
 //        		console.log("There is an error " + error.message);
 //        	});
 //    	}
	// }

	// get_doc("1caQbgCfH_v95uONNytWuZL4LLEFLDO2u");
	
	// Client ID and API key from the Developer Console
      // var CLIENT_ID = '214231396634-k9rpos37mknlm8daeoa06ffgbvks4bmq.apps.googleusercontent.com';
      // var API_KEY = 'AIzaSyCwxQGbEPzbn6Ced_b1L7hMK84ItoVNkFw';

      // // Array of API discovery doc URLs for APIs used by the quickstart
      // var DISCOVERY_DOCS = ["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"];

      // // Authorization scopes required by the API; multiple scopes can be
      // // included, separated by spaces.
      // var SCOPES = 'https://www.googleapis.com/auth/drive.metadata.readonly';

      // var authorizeButton = document.getElementById('authorize_button');
      // var signoutButton = document.getElementById('signout_button');

      // /**
      //  *  On load, called to load the auth2 library and API client library.
      //  */
      // function handleClientLoad() {
      //   gapi.load('client:auth2', initClient);
      // }

      // /**
      //  *  Initializes the API client library and sets up sign-in state
      //  *  listeners.
      //  */
      // function initClient() {
      //   gapi.client.init({
      //     apiKey: API_KEY,
      //     clientId: CLIENT_ID,
      //     discoveryDocs: DISCOVERY_DOCS,
      //     scope: SCOPES
      //   }).then(function () {
      //     // Listen for sign-in state changes.
      //     gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);

      //     // Handle the initial sign-in state.
      //     updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
      //     authorizeButton.onclick = handleAuthClick;
      //     signoutButton.onclick = handleSignoutClick;
      //   }, function(error) {
      //     appendPre(JSON.stringify(error, null, 2));
      //   });
      // }

      // *
      //  *  Called when the signed in status changes, to update the UI
      //  *  appropriately. After a sign-in, the API is called.
       
      // function updateSigninStatus(isSignedIn) {
      //   if (isSignedIn) {
      //     authorizeButton.style.display = 'none';
      //     signoutButton.style.display = 'block';
      //     listFiles();
      //   } else {
      //     authorizeButton.style.display = 'block';
      //     signoutButton.style.display = 'none';
      //   }
      // }

      // /**
      //  *  Sign in the user upon button click.
      //  */
      // function handleAuthClick(event) {
      //   gapi.auth2.getAuthInstance().signIn();
      // }

      // /**
      //  *  Sign out the user upon button click.
      //  */
      // function handleSignoutClick(event) {
      //   gapi.auth2.getAuthInstance().signOut();
      // }

      // /**
      //  * Append a pre element to the body containing the given message
      //  * as its text node. Used to display the results of the API call.
      //  *
      //  * @param {string} message Text to be placed in pre element.
      //  */
      // function appendPre(message) {
      //   var pre = document.getElementById('content');
      //   var textContent = document.createTextNode(message + '\n');
      //   pre.appendChild(textContent);
      // }

      // /**
      //  * Print files.
      //  */
      // function listFiles() {
      //   gapi.client.drive.files.list({
      //     'pageSize': 10,
      //     'fields': "nextPageToken, files(id, name)"
      //   }).then(function(response) {
      //     appendPre('Files:');
      //     var files = response.result.files;
      //     if (files && files.length > 0) {
      //       for (var i = 0; i < files.length; i++) {
      //         var file = files[i];
      //         appendPre(file.name + ' (' + file.id + ')');
      //       }
      //     } else {
      //       appendPre('No files found.');
      //     }
      //   });
      // }

      // initClient();
      var stock_holds = new Array();

	-->
	</script>
	<script type="text/javascript">
      // Client ID and API key from the Developer Console
      var CLIENT_ID = '831404325694-1dpirgt84o8ev9aohud28jgedr90in8b.apps.googleusercontent.com';
      var API_KEY = 'AIzaSyAuAxXdwJCH17k-QAJDZCjeknQDt8EFD8c';

      // Array of API discovery doc URLs for APIs used by the quickstart
      var DISCOVERY_DOCS = ["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"];

      // Authorization scopes required by the API; multiple scopes can be
      // included, separated by spaces.
      var SCOPES = 'https://www.googleapis.com/auth/drive.readonly https://www.googleapis.com/auth/drive.metadata.readonly https://www.googleapis.com/auth/drive.file';

      var authorizeButton = document.getElementById('authorize_button');
      var signoutButton = document.getElementById('signout_button');

      /**
       *  On load, called to load the auth2 library and API client library.
       */
      function handleClientLoad() {
        gapi.load('client:auth2', initClient);
      }

      /**
       *  Initializes the API client library and sets up sign-in state
       *  listeners.
       */
      function initClient() {
        gapi.client.init({
          apiKey: API_KEY,
          clientId: CLIENT_ID,
          discoveryDocs: DISCOVERY_DOCS,
          scope: SCOPES
        }).then(function () {
          // Listen for sign-in state changes.
          gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);

          // Handle the initial sign-in state.
          updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
          // gapi.auth2.getAuthInstance().signIn();
          // authorizeButton.onclick = handleAuthClick;
          // signoutButton.onclick = handleSignoutClick;
        }, function(error) {
           appendPre(JSON.stringify(error, null, 2));
        });
      }

      /**
       *  Called when the signed in status changes, to update the UI
       *  appropriately. After a sign-in, the API is called.
       */
      function updateSigninStatus(isSignedIn) {
        if (isSignedIn) {
          listFiles();
        } 
      }

      /**
       *  Sign in the user upon button click.
       */
      function handleAuthClick(event) {
        gapi.auth2.getAuthInstance().signIn();
      }

      /**
       *  Sign out the user upon button click.
       */
      function handleSignoutClick(event) {
        gapi.auth2.getAuthInstance().signOut();
      }

      /**
       * Append a pre element to the body containing the given message
       * as its text node. Used to display the results of the API call.
       *
       * @param {string} message Text to be placed in pre element.
       */
      function appendPre(message) {
        var pre = document.getElementById('content');
        console.log(message)
        var textContent = document.createTextNode(message + '\n');
        // pre.appendChild(textContent);
      }

      /**
       * Print files.
       */
      function listFiles() {
        gapi.client.drive.files.list({
          	'pageSize': 10,
          	'fields': "nextPageToken, files(id, name)"
        }).then(function(response) {
          	var files = response.result.files;
          	if (files && files.length > 0) {
              for (var i = 0; i < files.length; i++) {

            		var file = files[i];
            		appendPre(file.name + ' (' + file.id + ')');

            		if (file.name == 'current_holds') {

              		gapi.client.drive.files.export({
      						    fileId : file.id,
      						    mimeType : 'text/plain'
    						  }).then(function(success){
      							
                    console.log("asdfasdfab");
    						    console.log(success.body);
    						    var temp = success.body.split("\n");
    						    for (i in temp) {
    						    	stock_holds = stock_holds.concat(temp[i].split(" "));
    						    }
    						    console.log(stock_holds);   
      						
                  }, function(fail){
    						    
                    console.log(fail);
      							console.log("asdfasdfa");
    						    console.log('Error '+ fail.result.error.message);
    						  
                  });
                }
            	}
              load = true;
          	} else {
            	appendPre('No files found.');
          	}
        });
  //    	gapi.client.drive.files.export({
		//     fileId : '',
		//     mimeType : 'text'
		// }).then(function(success){
		// 	console.log("asdfasdfab");
		//     // console.log(success);
		//     // console.log("huh");
		//     //success.result    
		// }, function(fail){
		//     console.log(fail);
		// 	console.log("asdfasdfa");
		//     console.log('Error '+ fail.result.error.message);
		// })
      }

    </script>

    <script async defer src="https://apis.google.com/js/api.js"
      onload="this.onload=function(){};handleClientLoad()"
      onreadystatechange="if (this.readyState === 'complete') this.onload()">
    </script>

    <!-- <script src="https://apis.google.com/js/platform.js?onload=onLoadCallback" async defer></script>
	<script>
	window.onLoadCallback = function(){
	  listFiles();
	}
	</script> -->
    
	<noscript><link href="css/indexopenstyle.css" rel="stylesheet"></noscript>

</head>

<body>

	<header class="site-header">
		<div class="site-header-main">
			<div class="site-branding">
				<h1 class="site-title">stock algorithm v6.7</h1>
				<div class="site-description">an automated Robinhood system</div>
			</div>
			<nav class="site-navigation">
				<ul>
					<!-- Optional: Add a class of current-item to a navigation link to indicate which page you're currently viewing -->
					<!-- Use # links to create a single-page site -->
					<!-- Or create multiple pages and link to them separately here -->
					<li><a href="index.html" class="current-item">performance</a></li>
					<li><a href="todaysbuys.html">todays buys</a></li>
					<li><a href="history.html">history</a></li>
					<li><a href="about.html">about</a></li>
				</ul>
			</nav>
		</div>
	</header>

	<div class="leftbigcontainer">
		<h1 class="page-title">portfolio value</h1>

		<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  		<div id="chart_div" style=""></div>
  		<script>
  			google.charts.load('current', {packages: ['corechart', 'line']});
			google.charts.setOnLoadCallback(drawCurveTypes);

			function drawCurveTypes() {
			      var data = new google.visualization.DataTable();
			      data.addColumn('number', 'X');
			      data.addColumn('number', 'Dogs');

			      data.addRows([[0, 653.94], [1, 666.76], [2, 663.87], [3, 667.31],
			      				[4, 667.31], [5, 667.31], [6, 667.31], [7, 669.6],
								[8, 669.6], [9, 669.6], [10, 666.3], [11, 666.3],
								[12, 666.3], [13, 665.77], [14, 665.77], [15, 666.16],
								[16, 672.41], [17, 671], [18, 671], [19, 671],
								[20, 675.54], [21, 674.16], [22, 676.22], [23, 676.4],
								[24, 677.64], [25, 677.64], [26, 677.64], [27, 673.56],
								[28, 669.96], [29, 671.64], [30, 673.62], [31, 673.1],
								[32, 673.1], [33, 673.1], [34, 676.23], [35, 677.58],
								[36, 677.58], [37, 677.82], [38, 677.9], [39, 677.9],
								[40, 677.9], [41, 688.06], [42, 684.84], [43, 684.58],
								[44, 686.67], [45, 686.69], [46, 686.69], [47, 686.69],
								[48, 687.68], [49, 689.11], [50, 688.82], [51, 688.81],
								[52, 690.34], [53, 690.34], [54, 690.34], [55, 691.23],
								[56, 691.16], [57, 692.33], [58, 692.45], [59, 693.57],
								[60, 693.57], [61, 693.57], [62, 693.63], [63, 694.32],
								[64, 694.83], [65, 694.59], [66, 694.24], [67, 694.24],
								[68, 694.24], [69, 694.58], [70, 695.52], [71, 694.79],
								[72, 695.89], [73, 694.04], [74, 694.04], [75, 694.04],
								[76, 695.27], [77, 697.14], [78, 697.99], [79, 698.86],
								[80, 699.68], [81, 699.68], [82, 699.68], [83, 699.33],
								[84, 699.27], [85, 698.01], [86, 699.16], [87, 700.98],
								[88, 700.98], [89, 700.98], [90, 702.2], [91, 704.28],
								[92, 704.85], [93, 705.42], [94, 706.34]]);

			      var options = {
			        hAxis: {
			          title: 'Time'
			        },
			        // vAxis: {
			        //   title: 'Popularity'
			        // },
			        series: {
			          1: {curveType: 'function'}
			        },
                	height: 350,
                	// width: 400
			      };

			      var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
			      chart.draw(data, options);
			    }
  		</script>

  		<div class="btn-group" style="margin-top:13vh; margin-left: 4.5vw; align-items: center;">
			<div class="dropdown">
				<button onclick="location.href='overview.html';">1 week</button>
			</div>
			<div class="dropdown">
				<button onclick="location.href='history.html';">1 month</button>
			</div>
			<div class="dropdown">
				<button onclick="location.href='interviews.html';">3 months</button>
			</div>
			<div class="dropdown">
				<button onclick="location.href='interviews.html';">1 year</button>
			</div>
			<div class="dropdown">
				<button onclick="location.href='interviews.html';">all time</button>
			</div>
		</div>

	</div>	

	<div class="rightsmallcontainer" id="holds">
		<h1 class="page-title" style="margin-bottom: 1vh">current holds</h1>
		<script>
		<!--
      var counter = 0
			function waitFor(condition, callback) {
          counter++;
			    if(!condition()) {
			        console.log('waiting');
			        window.setTimeout(waitFor.bind(null, condition, callback), 100); /* this checks the flag every 100 milliseconds*/
			    } else {
			        console.log('done');
			        callback();
			    }
			}

			waitFor(() => counter > 15 || stock_holds.length > 0, () => {
				console.log("omg");
				console.log(stock_holds);
				var i;
				// var temp_string = '';
				for (i = 0; i < stock_holds.length / 2; i++) {
          // window.setTimeout(() => {
            var temp_string = '';
            temp_string = temp_string.concat("<div class='explanationWrapper'>\n", "<div class='logoName'>" + stock_holds[2*i] + "\n", 
            "</div>\n", "<div class='explanationText'>\n", stock_holds[(2*i) + 1] + " units\n", "</div>\n", "</div>\n");

            document.getElementById('holds').innerHTML = document.getElementById('holds').innerHTML.concat(temp_string);
          // }, 1000)
					
				}
				// console.log(temp_string);
			});

			

		-->
		</script>

		<!-- </div>
		<div class="explanationWrapper">
		</div>
		<div class="explanationWrapper">
		</div>
		<div class="explanationWrapper">
		</div>
		<div class="explanationWrapper">
		</div> -->
	</div>

</body>

</html>
